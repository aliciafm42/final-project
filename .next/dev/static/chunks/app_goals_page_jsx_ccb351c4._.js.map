{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/aliciamartinez/Downloads/Final/app/goals/page.jsx"],"sourcesContent":["\"use client\";\nimport { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/context/AuthContext\";\n\nexport default function GoalsPage() {\n  const { user } = useAuth();\n  const [goals, setGoals] = useState([]);\n  const [selectedGoals, setSelectedGoals] = useState([]);\n\n  const sustainableActions = [\n    \"Bike to work/school 3x/week\",\n    \"Reduce meat consumption\",\n    \"Use reusable bags\",\n    \"Plant a tree\",\n    \"Compost kitchen waste\",\n    \"Avoid single-use plastics\",\n    \"Use public transport\",\n    \"Buy local products\",\n    \"Save energy at home\",\n  ];\n\n  // Fetch user's goals from Neon database\n  const fetchGoals = async () => {\n    if (!user) return;\n    try {\n      const res = await fetch(\"/api/goals/list?userId=\" + user.id);\n      const data = await res.json();\n      const normalizedGoals = (data.goals || []).map((g) =>\n        typeof g === \"string\" ? { id: g, text: g } : g\n      );\n      setGoals(normalizedGoals);\n    } catch (err) {\n      console.error(\"Failed to fetch goals:\", err);\n    }\n  };\n\n  // Toggle card selection\n  const toggleSelection = (action) => {\n    setSelectedGoals((prev) =>\n      prev.includes(action) ? prev.filter((g) => g !== action) : [...prev, action]\n    );\n  };\n\n  // Add selected goals\n  const handleAddSelectedGoals = async () => {\n    if (!selectedGoals.length) return;\n\n    const addedGoals = [];\n    for (let text of selectedGoals) {\n      if (goals.some((g) => g.text === text)) continue;\n\n      try {\n        const res = await fetch(\"/api/goals/add\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ text, userId: user.id }),\n        });\n        const data = await res.json();\n        if (res.ok) addedGoals.push({ id: data.goal.id || text, text });\n      } catch (err) {\n        console.error(\"Failed to add goal:\", err);\n      }\n    }\n\n    setGoals([...goals, ...addedGoals]);\n    setSelectedGoals([]);\n  };\n\n  // Delete a goal\n  const handleDeleteGoal = async (goalId) => {\n    try {\n      await fetch(\"/api/goals/delete\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ id: goalId, userId: user.id }),\n      });\n      setGoals((prev) => prev.filter((g) => g.id !== goalId));\n    } catch (err) {\n      console.error(\"Failed to delete goal:\", err);\n    }\n  };\n\n  useEffect(() => {\n    fetchGoals();\n  }, [user]);\n\n  if (!user)\n    return (\n      <p className=\"text-center mt-20 text-red-600\">\n        Please login to view goals.\n      </p>\n    );\n\n  // Show only actions not already added\n  const availableActions = sustainableActions.filter(\n    (action) => !goals.some((g) => g.text === action)\n  );\n\n  return (\n    <div className=\"page-contain max-w-5xl mx-auto p-6 text-center\">\n      <h2 className=\"text-3xl font-bold text-green-700 mb-8\">\n        Pick Your Sustainable Goals\n      </h2>\n\n      {/* Sustainable Action Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-8 justify-items-center\">\n        {availableActions.length === 0 && (\n          <p className=\"text-gray-600\">You’ve added all available goals!</p>\n        )}\n        {availableActions.map((action) => {\n          const isSelected = selectedGoals.includes(action);\n          return (\n            <div\n              key={action}\n              onClick={() => toggleSelection(action)}\n              className={`cursor-pointer p-6 w-64 border rounded-lg transition-all duration-300 ${\n                isSelected\n                  ? \"bg-green-100 border-green-700 shadow-xl\"\n                  : \"bg-white border-green-700 hover:shadow-lg hover:bg-green-50\"\n              }`}\n            >\n              <p className=\"text-green-700 font-medium text-lg\">{action}</p>\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Confirm Button */}\n      {selectedGoals.length > 0 && (\n        <button\n          onClick={handleAddSelectedGoals}\n          className=\"bg-green-700 text-white font-bold px-10 py-3 rounded-lg hover:bg-green-800 transition mb-8\"\n        >\n          Add Selected Goals\n        </button>\n      )}\n\n      {/* Current Goals List */}\n      <h3 className=\"text-2xl font-semibold mb-4\">Your Goals:</h3>\n      {goals.length === 0 ? (\n        <p className=\"text-gray-600\">No goals added yet.</p>\n      ) : (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 justify-items-center\">\n          {goals.map((g) => (\n            <div\n              key={g.id}\n              className=\"p-6 border rounded-lg shadow bg-white text-green-700 font-medium text-center w-64 flex justify-between items-center\"\n            >\n              <span>{g.text}</span>\n              <button\n                onClick={() => handleDeleteGoal(g.id)}\n                className=\"text-red-600 font-bold hover:text-red-800 ml-2\"\n              >\n                ✕\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}